#!/usr/bin/env bash
# vim: ft=sh

set -euo pipefail

sudo -u '{{ nimbus_eth1_service_user }}' '{{ nimbus_eth1_repo_path }}'/build/nimbus \
    import \
    --network='{{ nimbus_eth1_network }}' \
    --data-dir='{{ nimbus_eth1_data_path }}/{{ nimbus_eth1_data_folder }}' \
    --log-level='{{ nimbus_eth1_log_level }}' \
    --metrics='{{ nimbus_eth1_metrics_enabled | to_json }}' \
{% if nimbus_eth1_metrics_enabled %}
    --metrics-address='{{ nimbus_eth1_metrics_address }}' \
    --metrics-port='{{ nimbus_eth1_metrics_port }}' \
{% endif %}
{% if nimbus_eth1_era1_dir is defined %}
    --era1-dir='{{ nimbus_eth1_era1_dir}}' \
{% endif %}
{% if nimbus_eth1_era_dir is defined %}
    --era-dir='{{ nimbus_eth1_era_dir}}'
{% endif %}
